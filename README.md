# 소방안전 빅데이터 공모전
> 프로젝트 진행 기간 : 2024.10.07 ~ 2024.10.21 \
> 건물별 화재 발생시 피해 예측을 위한 화재 확산 속도 지수 개발

### 목차
1. 배경
2. 목적
3. 활용 데이터
4. 데이터 분석 및 모델링
5. 결론 및 기대효과
6. 개인적인 회고
## 1. 배경
화재 사고는 인명과 재산에 큰 피해를 줄 수 있으며, 신속한 초기 대응이 피해를 줄이는 핵심요소이다. 본 연구는 건물의 자재, 구조 등 다양한 변수에 따라 달라지는 화재 확산 양상을 분석하여 맞춤형 화재 대응 전략을 제안하고자 한다.
## 2. 목적
화재 사고는 그 특성상 예측이 어렵고, 피해는 시간이 지날수록 비선형적으로 증가한다. 현재 화재 대응 시스템은 일률적인 ‘골든타임’ 개념에 기초하고 있지만, 이러한 접근법은 모든 상황에 적용하기 어렵고 비효율적인 대응을 초래할 가능성이 있다.   

본 연구의 목적은 다음과 같다.   
1. 건물별 화재 특성에 대한 심층 분석
* 건물의 구조적 특성, 용도, 사용 자재 등 다양한 요소를 종합적으로 분석하여 화재 확산 속도에 영향을 미치는 주요 요인을 파악
2. 화재 확산 속도 지수(FSI) 개발
* 각 건물의 화재 확산 양상을 수치화하여 지수화함으로써, 보다 정교하고 예측 가능한 화재 대응 전략을 마련
3. 피해 예측 및 효율적 자원 배분
* 화재 확산 속도 지수를 기반으로 화재 피해를 사전에 예측하고, 이를 통해 소방 자원의 효과적인 배치를 지원   

이를 통해, 화재 발생 초기부터 신속하고 적절한 대응이 가능하도록 시스템적 기반을 강화하고, 재산 및 인명 피해를 최소화하는 데 기여하고자 한다.

## 3. 활용데이터
1. 화재출동현황2023 (https://www.bigdata-119.kr/)
2. 건축물대장 - 표제부 (https://open.eais.go.kr/)
3. 건물 에너지정보 - 전기에너지, 가스에너지 (https://open.eais.go.kr/)
## 4. 데이터 분석 및 모델링
### 1) 데이터 준비
1. 데이터 수집
  - 화재출동 현황 2023 \
    건축물대장, 건물 에너지정보 데이터가 지번주소 기준임을 확인 후, 카카오 API를 사용하여 GIS_X좌표, GIS_Y좌표를 기준으로 지번주소를 생성
  - 건축데이터개방_건축물대장 표제부 \
    공공데이터포털 API를 사용하여, 지번주소를 기준으로 건물용도, 지붕자재, 사용승인일, 용적률, 용적률산정연면적, 연면적, 지상층수, 지하층수, 승용승강기수, 비상용승강기수 데이터를 수집 \
    이때 같은 지번주소에 여러 개의 표제부 정보가 존재함을 확인하여, 데이터 정합성을 위해 화재출동 현황 2023와 표제부 데이터의 연면적의 차가 가장 작은 데이터를 수집
  - 건물 에너지정보 \
    공공데이터포털 API를 사용하여, 지번주소를 기준으로 화재발생 달의 전기사용량, 가스사용량 데이터를 수집
  - 초기 수집 데이터 변수 정보 \
    <img width="529" alt="image" src="https://github.com/user-attachments/assets/99b71096-cfb9-4d70-a4b9-377442bad38d" />
2. 데이터 전처리
* 결측치 처리
  * `사용승인일` : 311개 제거
  * `풍속` : 15개 결측치를 같은 날 풍속 데이터가 존재할 경우에 따라 처리
    * 존재할 경우 : 같은 날 풍속 평균 사용
    * 존재하지 않을 경우 : 전날 다음날 풍속 평균 사용
  * `전기사용량 & 가스사용량` : 전기사용량 1932개, 가스사용량 2307개 결측치를 머신러닝 예측을 통해 결측치 처리
    * 예측과정
      1. 전기사용량, 가스사용량과 다른 변수 상관관계 확인 후, 상관계수가 0.2 이상인 용적률산정연면적, 층수, 승강기개수, 기온, 습도, 풍속 변수 사용
      2. Standard 스케일링과 XGBoost 모델를 사용
      3. 가스사용량 모델 R2 : 0.43, 전기사용량 모델 R2 : 0.45
* 변수 생성
  * `총층수`, `승강기개수`, `노후도`, `진압소요시간` : 생성
  * `화재발생시각`, `주중 및 주말` : 재범주화
  * 건물 용도 및 자재 변수 재범주화
    * `화재확산_건물용도` : 건축물의 용도와 화재 확산에 영향을 미치는 특성에 따라 4가지 변수로 재범주화
      1. 산업시설 : 연소성 물질이 많고 기계장비등을 많이 구비한 시설
      2. 주거밀집시설 : 인구밀집도가 높은 거주 및 돌봄시설
      3. 공공시설 : 비교적 밀도가 낮은 시설
      4. 대형집합시설 : 대규모인원이 모이는 공공 및 오락시설
    * `화재확산_건물자재` : 건축 자재들을 화재 확산 속도에 영향을 주는 수준에 따라 재범주화
      1. 고연소성 자재 : 가연성이 높으며, 구조적으로 불에 약한 자재
      2. 중간연소성 자재 : 기본적으로 불연성 자재이지만, 열이 가해 지면 금이 가거나 일부 손상이 가는 자재
      3. 중간위험 자재 : 합성재료이기 때문에 열에 약하거나 구조적 특성등의 복합적 요소에 따라 위험정도가 가변적인 자재
      4. 복합 고위험 자재 : 구조 내부에 있는 단열제의 소재에 따라 화재확산속도가 매우 빠른 자재
      5. 불연성 자재 : 불연성자재로써 내화성이 높고 구조적으로 안정적인 자재
    * `화재확산_지붕자재` : 지붕 자재명칭이 화재 확산에 미치는 영향이 잘 확인되도록 변수명을 재정의
      1. 차단형 : 화재에 대한 저항력이 매우 높고, 불이 퍼지기 어려운 자재
      2. 중간차단형 : 일정한 내화성이 있으나, 화재에 장시간 노출되면 손상이 가능한 자재
      3. 약차단형 : 초기 화재에는 저항하지만, 비교적 빠르게 열에 의해 손상되거나 파괴될 가능성이 있는 자재
* 화재확산속도지수(FSI) 생성   
  화재확산속도지수는 화재가 얼마나 빠르게 확산되었는지를 추정하는 지수로, 화재피해와 건물의 면적과 화재성장을 전반적으로 반영
  * 계산식   
    <img width="464" alt="image" src="https://github.com/user-attachments/assets/794e4372-74d0-4995-9443-823654050f99" />   
  * 설명   
    1. 재산피해금액은 화재피해 규모를 나타내고, 피해가 클수록 화재 확산 속도가 높았을 것으로 추정
    2. 화재성장곡선은 선행연구에서 시간 제곱임을 확인 후, 재산피해금액을 진압소요시간의 제곱으로 나눔
    3. 단위 면적에 대한 지표로 사용하기 위해 연면적으로 나눔
3. 분석 전 최종데이터셋   
   <img width="540" alt="image" src="https://github.com/user-attachments/assets/7a1b8703-248d-4e3e-b734-551c909e565d" />
### 2) EDA
1. 화재확산속도지수 기초통계량   
   <img width="469" alt="image" src="https://github.com/user-attachments/assets/1f88ef4d-f4d4-4f97-97be-b61155c0a3b1" />
   <img width="485" alt="image" src="https://github.com/user-attachments/assets/e3377a00-e35d-4f5f-aac8-f67741258a4d" />
   * Boxplot과 FSI의 기초통계량 분석 결과, FSI의 표준편차가 사분위수에 비해 매우 높아 최대 값과 최소값 간의 차이가 크며, 이상치가 다수 존재하는 것을 확인
   * 분위수를 기준으로 IQR를 계산하여 x < Q1 - 1.5 * IQR, x > Q3 + 1.5 * IQR인 값을 제거하는방식으로 정제
2. 독립변수 기초통계량확인
   * 수치형 변수
     <img width="459" alt="image" src="https://github.com/user-attachments/assets/63f3e61a-af07-4b75-9c2d-f9925d41851f" />
     <img width="527" alt="image" src="https://github.com/user-attachments/assets/aea80b18-f61d-4288-983c-a7e2d166f33a" />
     * 대체로 이상치가 많은 것을 보아 모델 적용 전 독립변수를 이상치의 영향을 줄이는 RobustScaling 기법을 활용하여 스케일링이 필요한 것을 판단
   * 범주형 변수
     <img width="518" alt="image" src="https://github.com/user-attachments/assets/3db35f7e-269e-4dfc-9ad2-9ea2cacae011" />
     <img width="543" alt="image" src="https://github.com/user-attachments/assets/9a6c74c8-4596-47c0-b03e-ab7388ab3bc1" />
     * 건물의 상태를 확인할 수 있는 주요변수인 건물용도, 건물자재, 지붕자재의 기초통계량 확인 결과 건물용도에서는 주거시설과 공공시설이 큰 비중을 차지하며, 건물자재에서는 불연성자재, 지붕자재에서는 차단형자재가 큰 비중을 차지함을 확인
3. 상관 분석
   * 상관관계 분석 표   
     <img width="311" alt="image" src="https://github.com/user-attachments/assets/c094d6d2-7e25-4089-ab84-b20f00f7dfa2" />
     * 상관분석 결과 FSI에 대한 상관계수가 총층수가 -0.348로 가장 크고 전기사용량 0.247, 승강기개수 -0.181, 노후도 0.155로 FSI에 대해 주요한 변수로 확인
     * spst의 pearson-r를 활용하여 자세한 상관분석을 진행
  * spst를 사용한 pearson-r 상관계수   
    <img width="362" alt="image" src="https://github.com/user-attachments/assets/4a60c61c-8e44-4908-a6c7-e8f80f9de96c" />
  * 그래프   
    <img width="537" alt="image" src="https://github.com/user-attachments/assets/d37a7f5a-84ec-41e2-bdf5-5bf4820a2543" />   
  * 결과
    * FSI에 대해 유의한 변수 : 노후도, 총층수, 승강기개수, 전기사용량, 가스사용량
    * 위 산점도와 회귀직선 그래프를 확인했을 때 데이터와 회귀직선 사이에 선형성이 나타나지 않아 모델링 과정에서 다중선형회귀모델은 적합하지 않을 것으로 판단
4. T/ANOVA-test
  * T/ANOVA-test 결과표
    <img width="296" alt="image" src="https://github.com/user-attachments/assets/39a29cfa-caad-4c79-bf36-389b56aac9ed" />
  * 그래프   
    <img width="493" alt="image" src="https://github.com/user-attachments/assets/be7213a4-aefc-4b47-903f-2cd061b5b72e" />
  * 결과
    * FSI에 대해 유의한 변수 : 화재확산_건물용도, 화재확산_건물자재, 화재확산_지붕자재
    * FSI의 개발 의도에 따라 건물별 특징이 FSI에 대해 유의한 것을 확인
  ### 3) 모델링
 1. 모델 선택 이유와 진행과정
   * 화재확산속도지수를 통해 건물들의 화재피해를 예측하고자 XGBoost 모델을 사용하여 진행
   * XGBoost 모델 선택 이유
     * 정형 데이터에서 신경망은 noisy feature에 쉽게 과적합되어 대부분의 경우 decision tree 계열의 모델보다 성능이 떨어짐
     * 독립변수와 종속변수 간에 선형성이 나타나지 않아 다중선형회귀 또한 적절하지 않음
     * 과적합 가능성을 줄이고 비선형 관계를 포착할 수 있는 트리기반모델인 XGBoost를 채택
    * 진행과정
      *  사용할 데이터의 크기가 1971개로 작다고 판단하여, GridSearchCV를 통해 하이퍼 파라미터 튜닝을 진행
      *  모델링 과정에서의 중요 변수를 도출하기 위해 Sklearn의 SelectKBest를 통해 feature selection을 진행
2. 데이터 스케일링
  * Feature로 사용할 데이터들은 전처리 단계에서 기초통계량을 확인했을 때 이상치들이 포함 되어 있는 것으로 확인되어 이상치에 영향이 적은 Sklearn의 RobustScaler를 사용
  * Target으로 사용할 FSI의 왜도와 첨도를 확인했을 때 왜도는 1.7로 비대칭적인 분포를 나타내고 첨도는 2.3으로 높게 나타나 log scaling을 진행
3. 하이퍼파라미터 튜닝
  * XGBoost의 하이퍼파라미터 튜닝을 위해 Sklearn의 GridSearchCV를 통해 튜닝   
```
param_grid = {‘max_depth’: [2, 3, 4, 5, 6],
              ‘n_estimators’: [100, 200, 300, 400, 500, 600, 700],
              ‘learning_rate’: [0.1, 0.05, 0.01, 0.015]}
```   
  * 최종 하이퍼파라미터로는 `{'learning_rate': 0.01, 'max_depth': 2, 'n_estimators': 300}`이 채택
4. Feature Selection
  * Sklearn의 SelectKBest를 통해 1부터 총 feature 수인 13까지의 k를 사용해 어떤 feature로 구성할지 선택
  * Training loss와 validation loss를 확인했을 때 k=8일 때 training loss가 가장 작았고, validation loss가 가장 작았던 k=4인 경우보다 R2 값이 더 높아 k=8로 선정
    * Training & Validation Loss 그래프   
      <img width="319" alt="image" src="https://github.com/user-attachments/assets/28e38997-2c7d-482f-9ed0-14108e1f414e" />
  * 상관관계 및 유의확률 분석을 통해 도출한 화재확산속도지수에 대해 유의미한 변수와 Feature Selection에서 선택된 8개의 변수는 동일
  *  `전기사용량`, `가스사용량`, `화재확산_지붕자재`, `화재확산_건물자재`, `화재확산_건물용도`, `승강기개수`, `총층수`, `노후도` 변수로 모델링을 진행
5. 모델링 결과
  * 5-Fold 검증을 통해 학습된 XGBoost모델의 평가지표
    * `R2` : 0.48967
    * `MAE`: 1.51675
  * Feature Importances   
    <img width="361" alt="image" src="https://github.com/user-attachments/assets/44a1f2cf-852f-4f03-a27c-707d27d460e4" />
6. 최종 결과
  * 상관관계 및 유의확률 분석을 통해 도출한 변수 8개와 feature selection을 통해 선택된 변수 8개가 동일
  * 모델링 결과 `총층수(51.1%)`, `승강기개수(19.9%)`, `화재확산_건물자재(8.6%)`, `화재확산_건물용도(7.2%)`, `전기사용량(4.6%)`, `가스사용량(4.0%)`, `노후도(2.6%)`, `화재확산_지붕자재(1.9%)` 순으로 화재확산속도지수에 높은 비중으로 영향을 미치는 것으로 분석

## 5. 결론 및 기대효과
* 본 연구를 통해 화재 피해는 시간이 지남에 따라 비선형적으로 증가한다는 사실을 확인
* `화재 확산 속도 지수(FSI)`는 화재 확산의 양상을 효과적으로 모델링하는 데 기여
* `건물의 용도`, `건축 자재`, `구조적 특성`이 화재 피해의 증가율에 미치는 영향을 정량적으로 분석한 결과, 다음과 같은 중요한 통찰을 얻음
1. 건축 자재와 용도에 따른 화재 확산 차이
* 불연성 자재로 건축된 건물은 화재 확산 속도가 현저히 낮았으며, 이는 사전에 화재 안전성을 높이기 위한 건축 자재 선택 중요성을 확인
* 상업용 건물은 주거용 건물에 비해 더 빠른 화재 확산 속도를 보였으며, 이는 상업 시설 특유의 개방적 구조와 다량의 연료물질이 영향을 미친 결과로 분석
2. 모델의 설명력과 실용성
* 본 연구에서 개발된 FSI는 데이터 기반으로 화재 피해 증가의 주요 요인을 설명하는 데 효과적임
* R-squared 값 약 0.5로 신뢰할 수 있는 예측력을 보임
* 화재 대응을 위한 의사결정 과정에서 신뢰할 수 있는 도구로 활용 가능함을 시사
3. 현장 적용 가능성
* 지수를 바탕으로 화재 확산 위험도가 높은 건물과 지역을 선별하여, 선제적인 화재 예방 및 대응 전략을 수립할 수 있는 가능성을 확인
* 고층 건물이나 오래된 건물의 경우 초기 화재 대응 자원을 우선 배치하는 방식을 통해 피해를 최소화할 수 있음
4. 화재 대응의 혁신적 접근 제시
* 본 연구는 화재 피해 예측이 단순한 추정이 아닌 데이터와 통계적 근거를 기반으로 가능하다는 점을 입증했으며, 이를 통해 기존의 화재 대응 방식을 과학적이고 체계적으로 변화시킬 수 있는 잠재력을 제시했음

이와 같은 연구 결과는 단순히 화재 피해 예측에 그치지 않고, 실제로 화재로 인한 인명과 재산 피해를 줄이는 데 기여할 수 있다. 또한, 해당 지표를 소방 및 도시 정책에 활용한다면 보다 안전한 사회 환경 조성에 중요한 역할을 할 것으로 기대된다.

## 6. 개인적인 회고

### 1. 이번 프로젝트를 통해 배운 것
* 이번 프로젝트를 통해 데이터 분석의 전체 과정을 종합적으로 경험하며 실질적인 성장을 이루었다. 데이터 정제와 시각화, 통계적 가설 검정, 그리고 결론 도출까지 체계적으로 접근하며, 분석의 뼈대를 구성하는 방법에 대한 명확한 감각을 익힐 수 있었다.
* 상관분석과, T&ANOVA-test에 대하여 자세히 배울 수 있었다.
* 다양한 스케일링 기법을 적용하여 데이터에 알맞은 스케일링 기법을 익혔다.
* 비선형 데이터를 다루는 과정에서 복잡한 변수들 간의 상관관계를 모델링하는 방법을 익혔다.
  
### 2. 보완이 필요한 점
* 분석을 진행하며 발견한 주요 개선점은 분석 목적에 맞는 적절한 방법론 선택이었다. 프로젝트 초반에는 다양한 고급 기법을 사용하려는 경향이 있었지만, 단순한 시각화나 기본 통계 분석이 더 명확하고 강력한 인사이트를 제공할 수 있음을 깨달았다.
* 비선형 증가를 반영한 화재 확산 지수 모델을 설계하는 과정에서 통계적 검증과 모델 간의 상관성을 더 정밀히 분석할 필요가 있었다.
* 모델링 결과를 평가하고 설명하는 데 있어 직관적이고 설득력 있는 해석의 중요성을 느꼈다.
  
### 3. 더 배우고 싶은 점
* 분석 결과를 효과적으로 전달할 수 있는 스토리텔링 기술을 배우고 싶다. 데이터를 단순히 수치화하는 데서 그치지 않고, 설득력 있는 스토리를 만들어내는 것이 중요하다는 점을 깨달았다.
* 비선형 데이터 모델링과 이를 효과적으로 검증하는 통계적 방법론에 대해 더 깊이 공부하고, 데이터의 특성을 더욱 세밀히 반영할 수 있는 모델 설계 능력을 향상시키고 싶다.


   










    
